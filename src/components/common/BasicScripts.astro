<script is:inline>
  console.log('basic_script', window.basic_script);
  if (!window.basic_script) {
    window.basic_script = true;

    function applyTheme(theme) {
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    }

    const initTheme = function () {
      if (
        localStorage.theme === 'dark' ||
        (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        applyTheme('dark');
      } else {
        applyTheme('light');
      }
    };
    initTheme();

    function attachEvent(selector, event, fn) {
      const matches = typeof selector === 'string' ? document.querySelectorAll(selector) : selector;
      if (matches && matches.length) {
        matches.forEach((elem) => {
          elem.addEventListener(event, (e) => fn(e, elem), false);
        });
      }
    }

    const onLoad = function () {
      attachEvent('[data-toggle-color-scheme]', 'click', function () {
        document.documentElement.classList.toggle('dark');
        localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
      });
    };

    window.onload = onLoad;

    document.addEventListener('astro:after-swap', () => {
      initTheme();
      onLoad();
    });
  }

</script>
